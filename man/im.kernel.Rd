% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/im.kernel.R
\name{im.kernel}
\alias{im.kernel}
\title{Compute Moving-Window (Kernel) Statistics on a Single-Layer Raster}
\usage{
im.kernel(input_image, mw = 3, stat = c("mean", "median", "sd", "var", "cv",
  "range"))
}
\arguments{
\item{input_image}{A \code{SpatRaster} object with a single layer.}

\item{mw}{A positive odd integer specifying the moving window size (default: 3).
The window is square (mw x mw), like in \code{terra::focal()}.}

\item{stat}{Character vector of statistics to compute. Options:
\code{c("mean", "median", "sd", "var", "cv", "range")}.
By default, all statistics are computed.}
}
\value{
A \code{SpatRaster} with one layer per requested statistic.
}
\description{
This function applies a moving window (kernel) operation to a single-layer
\code{SpatRaster} and returns one or more focal statistics (mean, median, sd, var,
cv, range).
}
\details{
\itemize{
\item \strong{cv} is computed as \code{sd / mean} (returns \code{NA} where mean is 0 or \code{NA}).
\item \strong{range} is computed as \code{max - min} within the moving window.
\item \code{NA} values are ignored when possible (\code{na.rm = TRUE}).
}

The function also plots all requested output layers using \code{terra::plot()} and
returns the result invisibly.
}
\examples{
library(terra)
r <- rast(nrows = 50, ncols = 50)
values(r) <- runif(ncell(r))

# All stats (default)
k_all <- im.kernel(r)

# Only mean and sd with a 5x5 window
k_ms <- im.kernel(r, mw = 5, stat = c("mean", "sd"))

plot(k_ms)
}
\seealso{
\code{\link[terra:focal]{terra::focal}}
}
\author{
Duccio Rocchini
}
